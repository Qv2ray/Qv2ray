language: cpp

matrix:
    include:
        - os: linux
          dist: xenial
          sudo: required
          env: OS=linux
        - os: osx
          env: OS=osx

before_install:
  - if [ "$OS" = "linux" ]; then    sudo apt-get update; fi

install:
  - if [ "$OS" = "linux" ]; then    sudo apt-get install qtchooser qt5-default qt5-qmake qtdeclarative5-dev python3-dev python-dev libpython3-dev qttools5-dev-tools; fi
  - if [ "$OS" = "osx" ];   then    brew install -v python3 cppcheck https://raw.githubusercontent.com/Homebrew/homebrew-core/master/Formula/qt.rb; fi
  - if [ "$OS" = "osx" ];   then    brew link -v --force qt; fi
  
before_script:
  - if [ "$OS" = "osx" ];   then    export QMAKESPEC=macx-clang; export QMAKESPEC=macx-g++; fi
  
script:
  - lrelease ./Hv2ray.pro
  - mkdir build && cd ./build
  - QT_SELECT=5 QTDIR=/usr/share/qt5 qmake ../
  - make
